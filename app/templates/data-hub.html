<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Hub - RawFuelFoods</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    // Initialize PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
  </script>
  <!-- DataTables CSS -->
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/select/1.7.0/css/select.dataTables.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">

  <style>
/* Reset and Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  line-height: 1.6;
  color: #333;
  background: #f5f5f5;
}

/* Navigation Styles */
.main-nav {
  background-color: #04f7f3;
    padding: 0.5rem 2rem;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
}

.nav-brand {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.logo {
    font-size: 1.5rem;
    font-weight: bold;
    text-decoration: none;
    padding: 0.5rem 0;
    transition: color 0.3s ease;
    color: #333;
}

.logo:hover {
    color: #007bff;
}

.nav-toggle {
    display: none;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    position: relative;
    width: 30px;
    height: 30px;
}

.hamburger,
.hamburger::before,
.hamburger::after {
    content: '';
    display: block;
    height: 3px;
    width: 100%;
    transition: all 0.3s ease;
    position: absolute;
}

.hamburger::before {
    top: -8px;
}

.hamburger::after {
    bottom: -8px;
}

.nav-menu {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin: 0;
    padding: 0;
    list-style: none;
}

.nav-item {
    position: relative;
}

.nav-link {
    text-decoration: none;
    padding: 1rem 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 500;
    transition: color 0.3s ease;
}

.nav-link:hover,


.nav-link i {
    font-size: 0.8em;
    transition: transform 0.3s ease;
}

.dropdown:hover .nav-link i {
    transform: rotate(-180deg);
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 200px;
    padding: 0.5rem 0;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s ease;
    z-index: 100;
}

.dropdown:hover .dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.dropdown-menu li a {
    padding: 0.75rem 1.5rem;
    display: block;
    text-decoration: none;
    transition: all 0.3s ease;
}


/* Responsive Navigation */
@media (max-width: 1200px) {
    .nav-menu {
        gap: 1rem;
    }

    .nav-link {
        font-size: 0.9rem;
    }
}

@media (max-width: 992px) {
    .nav-toggle {
        display: block;
    }

    .nav-menu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        flex-direction: column;
        padding: 1rem 0;
        align-items: stretch;
    }

    .nav-menu.active {
        display: flex;
    }

    .nav-item {
        width: 100%;
    }

    .nav-link {
        padding: 1rem 2rem;
        justify-content: space-between;
    }

    .dropdown-menu {
        position: static;
        background: rgba(255,255,255,0.1);
        box-shadow: none;
        opacity: 1;
        visibility: visible;
        transform: none;
        display: none;
    }

    .dropdown.active .dropdown-menu {
        display: block;
    }

    .dropdown-menu li a {
        ;
        padding-left: 3rem;
    }

    .dropdown-menu li a:hover {
        background: rgba(255,255,255,0.1);
    }
}

/* Adjust main content padding for fixed navbar */
main {
    padding-top: 80px;
}

/* Main Content Styles */
.main-content {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1rem;
}

.page-title {
  font-size: 2rem;
  margin-bottom: 1rem;
  color: #333;
}

.page-description {
  font-size: 1.1rem;
  color: #666;
  margin-bottom: 2rem;
}

/* Data Hub Layout */
.data-hub-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

/* Chart Containers */
.chart-container {
  background: #f8f9fa;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 30px;
  height: 350px;
}

.chart-container canvas {
  width: 100% !important;
  height: 300px !important;
}

/* Forms */
.data-form {
  background: #f8f9fa;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
}

.form-group {
  margin-bottom: 15px;
}

.form-group label {
  display: block;
  margin-bottom: 5px;
  font-weight: 600;
  color: #333;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.form-group textarea {
  min-height: 100px;
  resize: vertical;
}

/* Tables */
.data-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  background: #fff;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.data-table th,
.data-table td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}

.data-table th {
  background: #f4f6f8;
  font-weight: 600;
}

.data-table tr:hover {
  background: #f8f9fa;
}

/* Buttons */
.button {
  display: inline-block;
  padding: 8px 16px;
  background: #007bff;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.2s;
}

.button:hover {
  background: #0056b3;
}

.button.secondary {
  background: #6c757d;
}

.button.secondary:hover {
  background: #545b62;
}

/* Modal */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  overflow: hidden;
}

.modal-content {
  position: relative;
  background: #fff;
  width: 95%;
  max-width: 1200px;
  height: 90vh;
  margin: 2vh auto;
  border-radius: 12px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Error Messages */
#error-message {
  display: none;
  background: #dc3545;
  color: #fff;
  padding: 10px 15px;
  border-radius: 4px;
  margin-bottom: 20px;
}

/* Loading States */
.loading {
  position: relative;
  min-height: 200px;
}

.loading::after {
  content: 'Loading...';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 14px;
  color: #666;
}

/* Responsive Design */
@media (max-width: 768px) {
  .data-hub-container {
    padding: 10px;
  }

  .chart-container {
    padding: 15px;
  }

  .chart-container canvas {
    height: 250px !important;
  }

  .data-table th,
  .data-table td {
    padding: 8px 10px;
    font-size: 14px;
  }

  .modal-content {
    margin: 20px auto;
    width: 95%;
  }
}

/* Grid Layout for Dashboard */
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(800px, 1fr));
  gap: 30px;
  margin-bottom: 30px;
  padding: 20px;
}

.dashboard-card {
  background: #fff;
  border-radius: 12px;
  padding: 25px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  transition: box-shadow 0.3s ease;
}

.dashboard-card:hover {
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

.dashboard-card h2 {
  font-size: 1.5rem;
  color: #2c3e50;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 2px solid #f0f2f5;
}

/* Metrics and Stats */
.metric-card {
  text-align: center;
  padding: 15px;
}

.metric-value {
  font-size: 24px;
  font-weight: bold;
  color: #007bff;
  margin: 10px 0;
}

.metric-label {
  font-size: 14px;
  color: #666;
}

/* Status Indicators */
.status {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
}

.status-success {
  background: #d4edda;
  color: #155724;
}

.status-warning {
  background: #fff3cd;
  color: #856404;
}

.status-danger {
  background: #f8d7da;
  color: #721c24;
}

/* Search and Filters */
.search-bar {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

.search-input {
  flex: 1;
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.filter-dropdown {
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  min-width: 150px;
}

/* DataTable Styles */
.datatable-container {
  background: #fff;
  padding: 25px;
  border-radius: 8px;
  margin-top: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.datatable-container h3 {
  font-size: 1.2rem;
  margin-bottom: 20px;
  color: #2c3e50;
}

.action-buttons {
  margin-bottom: 15px;
}

.action-buttons button {
  margin-right: 10px;
}

.dt-buttons {
  margin-bottom: 20px;
  gap: 10px;
  display: flex;
}

.dt-button {
  background: #007bff !important;
  border: none !important;
  padding: 8px 16px !important;
  border-radius: 6px !important;
  font-size: 14px !important;
  transition: background-color 0.2s ease !important;
  color: #fff !important;
}

.dt-button:hover {
  background: #0056b3 !important;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

table.dataTable tbody tr.selected {
  background-color: #e3f2fd !important;
}

/* DataTable Specific Styles */
.dataTables_wrapper {
  margin-top: 15px;
  padding: 0;
}

table.dataTable {
  border-collapse: separate;
  border-spacing: 0;
  width: 100% !important;
  margin: 15px 0 !important;
}

table.dataTable thead th {
  background: #f8f9fa;
  padding: 12px 15px;
  border-bottom: 2px solid #e9ecef;
  font-weight: 600;
  color: #2c3e50;
}

table.dataTable tbody td {
  padding: 12px 15px;
  border-bottom: 1px solid #f0f2f5;
  vertical-align: middle;
}

table.dataTable tbody tr:hover {
  background-color: #f8f9fa;
}

/* Responsive Adjustments */
@media (max-width: 1200px) {
  .dashboard-grid {
    grid-template-columns: 1fr;
  }
  
  .dashboard-card {
    margin-bottom: 20px;
  }
}

@media (max-width: 768px) {
  .dashboard-card {
    padding: 15px;
  }
  
  .chart-container {
    height: 300px;
  }
  
  .chart-container canvas {
    height: 250px !important;
  }
  
  .datatable-container {
    padding: 15px;
    overflow-x: auto;
  }
  
  table.dataTable {
    font-size: 14px;
  }
}

/* Search and Filter Styles */
.dataTables_filter {
  margin-bottom: 15px;
}

.dataTables_filter input {
  padding: 8px 12px;
  border: 1px solid #dee2e6;
  border-radius: 4px;
  width: 200px;
}

.dataTables_length select {
  padding: 6px 10px;
  border: 1px solid #dee2e6;
  border-radius: 4px;
  margin: 0 5px;
}

/* Pagination Styles */
.dataTables_paginate {
  margin-top: 15px;
}

.paginate_button {
  padding: 5px 10px;
  margin: 0 2px;
  border: 1px solid #dee2e6;
  border-radius: 4px;
  cursor: pointer;
}

.paginate_button.current {
  background: #007bff;
  ;
  border-color: #007bff;
}

.paginate_button:hover:not(.current) {
  background: #f8f9fa;
}

.reports-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.reports-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.report-card {
  background: #fff;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: transform 0.2s;
}

.report-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

.report-card h3 {
  margin: 0 0 10px 0;
  color: #2c3e50;
}

.report-meta {
  font-size: 0.9em;
  color: #666;
  margin-bottom: 10px;
}

.report-summary {
  color: #444;
  margin-bottom: 15px;
}

.report-actions {
  display: flex;
  gap: 10px;
}

.report-actions button {
  padding: 5px 10px;
  font-size: 0.9em;
}

#reportFormModal .modal-content {
  max-width: 600px;
}

#reportContent {
  min-height: 200px;
}

/* Enhanced Report Styles */
.report-detail {
  display: flex;
  flex-direction: column;
  height: 100%;
  background: white;
  font-family: 'Georgia', serif;
  line-height: 1.6;
  overflow: hidden;
}

.report-detail .header {
  flex: 0 0 auto;
  text-align: center;
  padding: 40px 40px 20px;
  background: white;
  border-bottom: 2px solid #2c3e50;
  z-index: 2;
}

.report-detail .content-wrapper {
  flex: 1;
  overflow-y: auto;
  padding: 40px;
  background: white;
}

.report-detail .content {
  max-width: 1000px;
  margin: 0 auto;
}

.report-detail .title {
  font-size: 2.5em;
  color: #2c3e50;
  margin-bottom: 10px;
}

.report-detail .meta {
  color: #666;
  font-size: 1.1em;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin: 20px 0;
}

.report-detail .meta-item {
  text-align: center;
}

.report-detail .meta-label {
  font-weight: bold;
  color: #2c3e50;
}

.report-detail .summary {
  font-size: 1.2em;
  font-style: italic;
  color: #666;
  margin: 30px 0;
  padding: 20px;
  background: #f8f9fa;
  border-left: 4px solid #2c3e50;
}

.report-detail .content h3 {
  color: #2c3e50;
  font-size: 1.5em;
  margin: 30px 0 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid #dee2e6;
}

.report-detail .content ul {
  list-style-type: none;
  padding-left: 0;
}

.report-detail .content li {
  margin: 15px 0;
  padding-left: 25px;
  position: relative;
}

.report-detail .content li:before {
  content: "•";
  color: #2c3e50;
  font-weight: bold;
  position: absolute;
  left: 0;
}

.report-detail .content p {
  margin: 20px 0;
}

.report-detail .metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.report-detail .metric-card {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  text-align: center;
}

.report-detail .metric-value {
  font-size: 2em;
  color: #2c3e50;
  font-weight: bold;
}

.report-detail .metric-label {
  color: #666;
  margin-top: 10px;
}

.report-detail .recommendations {
  background: #e3f2fd;
  padding: 25px;
  border-radius: 8px;
  margin: 30px 0;
}

.report-detail .recommendations h3 {
  color: #1565c0;
  border-bottom: none;
  margin-top: 0;
}

.report-actions {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 10px;
  z-index: 3;
  background: white;
  padding: 10px;
  border-radius: 30px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.action-button {
  background: #2c3e50;
  ;
  padding: 12px 24px;
  border-radius: 30px;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.action-button:hover {
  background: #34495e;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.action-button i {
  font-size: 1.2em;
}

/* Print Styles */
@media print {
  @page {
    margin: 2cm;
  }

  body * {
    visibility: hidden;
  }

  .report-detail,
  .report-detail * {
    visibility: visible;
  }

  .report-detail {
    height: auto;
    overflow: visible;
  }

  .report-detail .content-wrapper {
    overflow: visible;
  }

  .content {
    margin: 0 !important;
  }

  .report-actions {
    display: none;
  }

  .report-detail .header {
    margin-bottom: 30px;
  }

  .report-detail .content {
    font-size: 12pt;
  }

  .report-detail h3 {
    break-after: avoid;
  }

  .report-detail li {
    break-inside: avoid;
  }
}

/* Library of Kemet Styles */
.library-of-kemet {
  margin-top: 2rem;
}

.library-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.documents-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.document-card {
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  cursor: pointer;
}

.document-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

.document-thumbnail {
  width: 100%;
  height: 160px;
  object-fit: cover;
  border-bottom: 1px solid #eee;
}

.document-info {
  padding: 15px;
}

.document-info h3 {
  margin: 0 0 8px 0;
  font-size: 1.1rem;
  color: #2c3e50;
}

.document-meta {
  font-size: 0.9rem;
  color: #666;
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
}

.document-description {
  font-size: 0.9rem;
  color: #444;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.document-viewer {
  display: flex;
  flex-direction: column;
  height: 90vh;
  width: 90vw;
  max-width: 1200px;
}

.document-header {
  padding: 20px;
  border-bottom: 1px solid #eee;
}

.document-content {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  padding: 20px;
  flex: 1;
  overflow: hidden;
}

.pdf-viewer {
  height: 100%;
  overflow-y: auto;
  border: 1px solid #eee;
  border-radius: 8px;
}

.document-text {
  height: 100%;
  overflow-y: auto;
  padding: 15px;
  border: 1px solid #eee;
  border-radius: 8px;
  background: #f8f9fa;
}

#extractedText {
  min-height: 100%;
  padding: 15px;
  font-family: 'Georgia', serif;
  line-height: 1.6;
  color: #333;
}

.document-actions {
  padding: 20px;
  border-top: 1px solid #eee;
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

@media (max-width: 768px) {
  .document-content {
    grid-template-columns: 1fr;
  }
  
  .document-viewer {
    width: 95vw;
  }
}

/* Document Form Styles */
.document-form {
  max-width: 600px;
  margin: 0 auto;
}

.document-form .form-group {
  margin-bottom: 20px;
}

.document-form input[type="file"] {
  padding: 10px;
  border: 2px dashed #ddd;
  border-radius: 8px;
  width: 100%;
  cursor: pointer;
}

.document-form input[type="file"]:hover {
  border-color: #2c3e50;
}
  </style>
</head>
<body>
  <nav class="main-nav">
    <div class="nav-brand">
        <a href="/" class="logo">RawFuelFoods</a>
        <button class="nav-toggle" aria-label="Toggle Navigation">
            <span class="hamburger"></span>
        </button>
    </div>
    
    <ul class="nav-menu">
        <li class="nav-item">
            <a href="/about" class="nav-link">About & Contact</a>
        </li>
        <li class="nav-item dropdown">
            <a href="/farms" class="nav-link">Farms <i class="fas fa-chevron-down"></i></a>
            <ul class="dropdown-menu">
                <li><a href="/farms/locations">Locations</a></li>
                <li><a href="/farms/products">Products</a></li>
                <li><a href="/farms/sustainability">Sustainability</a></li>
                <li><a href="/farms/partners">Partners</a></li>
            </ul>
        </li>
        <li class="nav-item dropdown">
            <a href="/eat-drink" class="nav-link">Eat & Drink <i class="fas fa-chevron-down"></i></a>
            <ul class="dropdown-menu">
                <li><a href="/eat-drink/menu">Menu</a></li>
                <li><a href="/eat-drink/specials">Daily Specials</a></li>
                <li><a href="/eat-drink/catering">Catering</a></li>
                <li><a href="/eat-drink/events">Events</a></li>
            </ul>
        </li>
        <li class="nav-item dropdown">
            <a href="/health-wellness" class="nav-link">Health/Wellness <i class="fas fa-chevron-down"></i></a>
            <ul class="dropdown-menu">
                <li><a href="/health-wellness/programs">Programs</a></li>
                <li><a href="/health-wellness/nutrition">Nutrition</a></li>
                <li><a href="/health-wellness/coaching">Coaching</a></li>
                <li><a href="/health-wellness/resources">Resources</a></li>
            </ul>
        </li>
        <li class="nav-item dropdown">
            <a href="/data-hub" class="nav-link active">Data Hub <i class="fas fa-chevron-down"></i></a>
            <ul class="dropdown-menu">
                <li><a href="#farm-performance">Farm Performance</a></li>
                <li><a href="#resource-metrics">Resource Metrics</a></li>
                <li><a href="#community-impact">Community Impact</a></li>
                <li><a href="#reports-analysis">Reports & Analysis</a></li>
            </ul>
        </li>
        <li class="nav-item">
            <a href="/communications" class="nav-link">Communications</a>
        </li>
        <li class="nav-item dropdown">
            <a href="/networks" class="nav-link">Networks <i class="fas fa-chevron-down"></i></a>
            <ul class="dropdown-menu">
                <li><a href="/networks/partners">Partners</a></li>
                <li><a href="/networks/community">Community</a></li>
                <li><a href="/networks/initiatives">Initiatives</a></li>
            </ul>
        </li>
        <li class="nav-item">
            <a href="/blog" class="nav-link">Blog</a>
        </li>
        <li class="nav-item">
            <a href="/outdoors-rx" class="nav-link">Outdoors RX</a>
        </li>
        <li class="nav-item dropdown">
            <a href="/events" class="nav-link">Events <i class="fas fa-chevron-down"></i></a>
            <ul class="dropdown-menu">
                <li><a href="/events/calendar">Calendar</a></li>
                <li><a href="/events/workshops">Workshops</a></li>
                <li><a href="/events/classes">Classes</a></li>
                <li><a href="/events/special">Special Events</a></li>
            </ul>
        </li>
        </ul>
      </nav>

  <main class="main-content">
    <div class="hero-banner">
      <img src="images/farmyield.png" alt="Data-Driven Urban Farming Analytics" class="hero-image">
      <div class="hero-overlay">
        <h1>Data-Driven Insights</h1>
        <p>Transforming urban agriculture through advanced analytics and real-time monitoring</p>
      </div>
    </div>

    <div class="data-hub-intro">
      <h1 class="page-title">Data Hub</h1>
      <p class="page-description">Our comprehensive analytics platform transforms raw data from urban farms into actionable insights, enabling data-driven decisions for optimizing yields, resources, and sustainability. Through IoT sensors and advanced monitoring, we track key metrics like soil health, water efficiency, and crop productivity while measuring broader community impact through food security improvements, economic benefits, and environmental sustainability indicators.</p>
    </div>

    <style>
      .hero-banner {
        position: relative;
        height: 60vh;
        min-height: 400px;
        overflow: hidden;
        margin-bottom: 4rem;
      }

      .hero-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: brightness(0.7);
        transform: scale(1.02);
        transition: transform 0.3s ease;
      }

      .hero-banner:hover .hero-image {
        transform: scale(1.05);
      }

      .hero-overlay {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        color: #ffffff;
        width: 80%;
        max-width: 800px;
        padding: 2rem;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(5px);
        border-radius: 10px;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      }

      .hero-overlay h1 {
        font-size: 3.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        text-transform: uppercase;
        letter-spacing: 2px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .hero-overlay p {
        font-size: 1.2rem;
        line-height: 1.6;
        margin: 0;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      }

      .data-hub-intro {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem 4rem;
        text-align: center;
      }

      .page-title {
        font-size: 2.5rem;
        color: #2c3e50;
        margin-bottom: 1.5rem;
        position: relative;
        display: inline-block;
      }

      .page-title:after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 4px;
        background: #3498db;
        border-radius: 2px;
      }

      .page-description {
        font-size: 1.1rem;
        line-height: 1.8;
        color: #555;
        max-width: 900px;
        margin: 0 auto;
      }

      @media (max-width: 768px) {
        .hero-banner {
          height: 50vh;
        }

        .hero-overlay h1 {
          font-size: 2.5rem;
        }

        .hero-overlay p {
          font-size: 1rem;
        }

        .page-title {
          font-size: 2rem;
        }

        .page-description {
          font-size: 1rem;
        }
      }
    </style>

    <div class="data-hub-container">
      <div id="error-message"></div>

      <!-- Dashboard Grid -->
      <div class="dashboard-grid">
        <!-- Farm Performance -->
        <div class="dashboard-card">
          <h2>Farm Performance</h2>
          <div class="chart-container">
          <canvas id="farmPerformanceChart"></canvas>
          </div>
          <div class="datatable-container">
            <h3>Farm Data Management</h3>
            <table id="farmDataTable" class="display responsive nowrap" style="width:100%">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Crop Type</th>
                  <th>Yield Amount</th>
                  <th>Area (sq ft)</th>
                  <th>Notes</th>
                  <th>Date Added</th>
                </tr>
              </thead>
            </table>
        </div>
        </div>

        <!-- Resource Metrics -->
        <div class="dashboard-card">
          <h2>Resource Metrics</h2>
          <div class="chart-container">
          <canvas id="resourceEfficiencyChart"></canvas>
          </div>
          <div class="datatable-container">
            <h3>Resource Data Management</h3>
            <table id="resourceDataTable" class="display responsive nowrap" style="width:100%">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Metric Type</th>
                  <th>Value</th>
                  <th>Unit</th>
                  <th>Date</th>
                  <th>Notes</th>
                </tr>
              </thead>
            </table>
        </div>
          </div>

        <!-- Community Impact -->
        <div class="dashboard-card">
          <h2>Community Impact</h2>
          <div class="chart-container">
            <canvas id="communityEngagementChart"></canvas>
            </div>
          <div class="datatable-container">
            <h3>Community Data Management</h3>
            <table id="communityDataTable" class="display responsive nowrap" style="width:100%">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Program Type</th>
                  <th>Participants</th>
                  <th>Location</th>
                  <th>Date</th>
                  <th>Feedback Score</th>
                  <th>Notes</th>
                </tr>
              </thead>
            </table>
            </div>
            </div>
        </div>

      <!-- Reports & Analysis -->
      <div class="dashboard-card">
        <h2>Reports & Analysis</h2>
        <div class="reports-controls">
          <div class="search-bar">
            <input type="text" id="reportSearch" class="search-input" placeholder="Search reports...">
            <select id="reportFilter" class="filter-dropdown">
              <option value="all">All Types</option>
              <option value="farm">Farm Reports</option>
              <option value="resource">Resource Reports</option>
              <option value="community">Community Reports</option>
              </select>
            </div>
          <button onclick="openReportForm()" class="button">Create New Report</button>
        </div>
        <div id="reportsContainer" class="reports-grid"></div>
      </div>

      <!-- Library of Kemet -->
      <div class="dashboard-card library-of-kemet">
        <h2>Library of Kemet</h2>
        <div class="library-controls">
          <div class="search-bar">
            <input type="text" id="documentSearch" class="search-input" placeholder="Search documents...">
            <select id="documentFilter" class="filter-dropdown">
              <option value="all">All Types</option>
              <option value="research">Research Papers</option>
              <option value="guides">Farming Guides</option>
              <option value="historical">Historical Documents</option>
            </select>
          </div>
          <button onclick="openDocumentUpload()" class="button">
            <i class="fas fa-upload"></i> Upload Document
          </button>
        </div>
        <div id="documentsContainer" class="documents-grid"></div>
      </div>

      <!-- Document Upload Modal -->
      <div id="documentUploadModal" class="modal">
        <div class="modal-content">
          <h2>Upload Document</h2>
          <form id="documentUploadForm" class="document-form">
            <div class="form-group">
              <label for="documentTitle">Title</label>
              <input type="text" id="documentTitle" name="title" required>
            </div>
            <div class="form-group">
              <label for="documentType">Type</label>
              <select id="documentType" name="type" required>
                <option value="research">Research Paper</option>
                <option value="guides">Farming Guide</option>
                <option value="historical">Historical Document</option>
              </select>
            </div>
            <div class="form-group">
              <label for="documentDescription">Description</label>
              <textarea id="documentDescription" name="description" required></textarea>
            </div>
            <div class="form-group">
              <label for="documentFile">PDF File</label>
              <input type="file" id="documentFile" name="file" accept=".pdf" required>
            </div>
            <div class="form-group">
              <label for="documentThumbnail">Cover Image (Optional)</label>
              <input type="file" id="documentThumbnail" name="thumbnail" accept="image/*">
            </div>
            <div class="modal-buttons">
              <button type="submit" class="button">Upload</button>
              <button type="button" onclick="closeDocumentUpload()" class="button secondary">Cancel</button>
            </div>
          </form>
        </div>
      </div>

      <!-- Document View Modal -->
      <div id="documentViewModal" class="modal">
        <div class="modal-content document-viewer">
          <div class="document-header">
            <h2 id="viewDocumentTitle"></h2>
            <div class="document-meta">
              <span id="viewDocumentType"></span>
              <span id="viewDocumentDate"></span>
            </div>
          </div>
          <div class="document-content">
            <div class="pdf-viewer">
              <canvas id="pdfCanvas"></canvas>
            </div>
            <div class="document-text">
              <div id="extractedText" contenteditable="true"></div>
            </div>
          </div>
          <div class="document-actions">
            <button onclick="savePdfChanges()" class="button">
              <i class="fas fa-save"></i> Save Changes
            </button>
            <button onclick="downloadPdf()" class="button">
              <i class="fas fa-download"></i> Download
            </button>
            <button onclick="closeDocumentView()" class="button secondary">
              <i class="fas fa-times"></i> Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div id="reportModal" class="modal">
      <div class="modal-content"></div>
      </div>

    <!-- Modal for CRUD operations -->
    <div id="crudModal" class="modal">
    <div class="modal-content">
        <h2 id="modalTitle">Add/Edit Record</h2>
        <form id="crudForm">
          <!-- Form fields will be dynamically added here -->
        </form>
        <div class="modal-buttons">
          <button type="button" onclick="saveCrudForm()" class="button">Save</button>
          <button type="button" onclick="closeModal()" class="button secondary">Cancel</button>
        </div>
    </div>
  </div>

    <footer>
      <p>Contact: Call 206.718.9951 | rawfuelfoods@gmail.com</p>
  </footer>
  </main>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>

  <script>
    // Event listener cleanup
    function cleanupEventListeners() {
      const reportForm = document.getElementById('report-form');
      if (reportForm) {
        reportForm.removeEventListener('submit', handleReportSubmit);
      }

      const documentUploadForm = document.getElementById('documentUploadForm');
      if (documentUploadForm) {
        documentUploadForm.removeEventListener('submit', handleDocumentUpload);
      }

      const searchInput = document.getElementById('search-input');
      if (searchInput) {
        searchInput.removeEventListener('input', handleSearch);
      }

      const typeFilter = document.getElementById('type-filter');
      if (typeFilter) {
        typeFilter.removeEventListener('change', handleFilter);
      }
    }

    // Call cleanup when closing modals
    function closeModal() {
      cleanupEventListeners();
      document.getElementById('crudModal').style.display = 'none';
      document.getElementById('reportModal').style.display = 'none';
    }

    function closeDocumentUpload() {
      cleanupEventListeners();
      document.getElementById('documentUploadModal').style.display = 'none';
      document.getElementById('documentUploadForm').reset();
    }

    function closeDocumentView() {
      cleanupEventListeners();
      document.getElementById('documentViewModal').style.display = 'none';
    }

    // Initialize everything when the page loads
    document.addEventListener('DOMContentLoaded', function() {
      initializeEventListeners();
      initializeDataTables();
      initializeCharts();
      loadInitialData();
      loadReports();
      loadDocuments();
    });

    // Cleanup on page unload
    window.addEventListener('unload', cleanupEventListeners);

    function initializeEventListeners() {
      // Form submission handlers
      const reportForm = document.getElementById('report-form');
      if (reportForm) {
        reportForm.addEventListener('submit', handleReportSubmit);
      }

      const documentUploadForm = document.getElementById('documentUploadForm');
      if (documentUploadForm) {
        documentUploadForm.addEventListener('submit', handleDocumentUpload);
      }

      // Search and filter handlers
      const searchInput = document.getElementById('search-input');
      if (searchInput) {
        searchInput.addEventListener('input', handleSearch);
      }

      const typeFilter = document.getElementById('type-filter');
      if (typeFilter) {
        typeFilter.addEventListener('change', handleFilter);
      }

      // Button click handlers
      const buttons = document.querySelectorAll('.action-button');
      buttons.forEach(button => {
        button.addEventListener('click', handleButtonClick);
      });
    }

    function initializeDataTables() {
      // Initialize DataTables with configuration
      $('#farmDataTable').DataTable({
        responsive: true,
        dom: 'Bfrtip',
        buttons: ['copy', 'csv', 'excel', 'pdf', 'print']
      });

      $('#resourceDataTable').DataTable({
        responsive: true,
        dom: 'Bfrtip',
        buttons: ['copy', 'csv', 'excel', 'pdf', 'print']
      });

      $('#communityDataTable').DataTable({
        responsive: true,
        dom: 'Bfrtip',
        buttons: ['copy', 'csv', 'excel', 'pdf', 'print']
      });
    }

    function initializeCharts() {
      // Initialize Chart.js charts
      const farmCtx = document.getElementById('farmPerformanceChart');
      if (farmCtx) {
        new Chart(farmCtx, {
          type: 'bar',
          data: {
            labels: [],
            datasets: [{
              label: 'Farm Performance',
              data: [],
              backgroundColor: 'rgba(54, 162, 235, 0.2)',
              borderColor: 'rgba(54, 162, 235, 1)',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true
              }
            }
          }
        });
      }

      const resourceCtx = document.getElementById('resourceEfficiencyChart');
      if (resourceCtx) {
        new Chart(resourceCtx, {
          type: 'line',
          data: {
            labels: [],
            datasets: [{
              label: 'Resource Efficiency',
              data: [],
              borderColor: 'rgba(75, 192, 192, 1)',
              tension: 0.1
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true
              }
            }
          }
        });
      }

      const communityCtx = document.getElementById('communityEngagementChart');
      if (communityCtx) {
        new Chart(communityCtx, {
          type: 'pie',
          data: {
            labels: [],
            datasets: [{
              data: [],
              backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)'
              ],
              borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)'
              ],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true
          }
        });
      }
    }

    async function loadInitialData() {
      try {
        // Load data for tables and charts
        const [farmData, resourceData, communityData] = await Promise.all([
          fetchData('/api/farm-data'),
          fetchData('/api/resource-metrics'),
          fetchData('/api/community-impact')
        ]);

        updateTables(farmData, resourceData, communityData);
        updateCharts(farmData, resourceData, communityData);
      } catch (error) {
        console.error('Error loading data:', error);
        showError('Failed to load data');
      }
    }

    async function fetchData(endpoint) {
      const response = await fetch(endpoint);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return await response.json();
    }

    function updateTables(farmData, resourceData, communityData) {
      // Update DataTables with new data
      $('#farmDataTable').DataTable().clear().rows.add(farmData).draw();
      $('#resourceDataTable').DataTable().clear().rows.add(resourceData).draw();
      $('#communityDataTable').DataTable().clear().rows.add(communityData).draw();
    }

    function updateCharts(farmData, resourceData, communityData) {
      // Update Chart.js charts with new data
      // Implementation depends on your data structure
    }

    function showError(message) {
      const errorDiv = document.getElementById('error-message');
      if (errorDiv) {
        errorDiv.textContent = message;
        errorDiv.style.display = 'block';
        setTimeout(() => {
          errorDiv.style.display = 'none';
        }, 5000);
      }
    }

    // Event Handlers
    function handleReportSubmit(event) {
      event.preventDefault();
      // Handle report form submission
    }

    function handleDocumentUpload(event) {
      event.preventDefault();
      // Handle document upload
    }

    function handleSearch(event) {
      // Handle search functionality
    }

    function handleFilter(event) {
      // Handle filtering
    }

    function handleButtonClick(event) {
      // Handle button clicks
    }

    async function loadReports() {
      try {
        const response = await fetch('/api/reports');
        if (!response.ok) {
          throw new Error('Failed to fetch reports');
        }
        const reports = await response.json();
        displayReports(reports);
      } catch (error) {
        console.error('Error loading reports:', error);
        showError('Failed to load reports');
      }
    }

    function displayReports(reports) {
      const reportsContainer = document.getElementById('reportsContainer');
      if (!reportsContainer) return;

      if (!reports || reports.length === 0) {
        reportsContainer.innerHTML = '<div class="no-reports">No reports available</div>';
        return;
      }

      const reportCards = reports.map(report => `
        <div class="report-card">
          <h3>${escapeHtml(report.title)}</h3>
          <div class="report-meta">
            <span>${escapeHtml(report.type)}</span>
            <span>${new Date(report.date).toLocaleDateString()}</span>
            <span>${escapeHtml(report.author)}</span>
          </div>
          <div class="report-summary">${escapeHtml(report.summary)}</div>
          <div class="report-actions">
            <button onclick="viewReport(${report.id})" class="button">View</button>
            <button onclick="editReport(${report.id})" class="button">Edit</button>
            <button onclick="deleteReport(${report.id})" class="button secondary">Delete</button>
          </div>
        </div>
      `).join('');

      reportsContainer.innerHTML = reportCards;
    }

    function escapeHtml(unsafe) {
      return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    async function viewReport(id) {
      try {
        const response = await fetch(`/api/reports/${id}`);
        if (!response.ok) throw new Error('Failed to fetch report');
        const report = await response.json();
        
        const modal = document.getElementById('reportModal');
        if (!modal) return;

        modal.innerHTML = `
          <div class="modal-content report-detail">
            <div class="header">
              <h2>${escapeHtml(report.title)}</h2>
              <div class="meta">
                <div class="meta-item">
                  <div class="meta-label">Type</div>
                  <div>${escapeHtml(report.type)}</div>
                </div>
                <div class="meta-item">
                  <div class="meta-label">Date</div>
                  <div>${new Date(report.date).toLocaleDateString()}</div>
                </div>
                <div class="meta-item">
                  <div class="meta-label">Author</div>
                  <div>${escapeHtml(report.author)}</div>
                </div>
              </div>
            </div>
            <div class="content-wrapper">
              <div class="content">
                ${report.content}
              </div>
            </div>
            <div class="report-actions">
              <button onclick="editReport(${report.id})" class="action-button">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button onclick="closeReportModal()" class="action-button">
                <i class="fas fa-times"></i> Close
              </button>
            </div>
          </div>
        `;

        modal.style.display = 'block';
      } catch (error) {
        console.error('Error viewing report:', error);
        showError('Failed to load report');
      }
    }

    async function editReport(id) {
      try {
        const response = await fetch(`/api/reports/${id}`);
        if (!response.ok) throw new Error('Failed to fetch report');
        const report = await response.json();
        
        openReportForm();
        
        document.getElementById('reportTitle').value = report.title;
        document.getElementById('reportType').value = report.type;
        document.getElementById('reportSummary').value = report.summary;
        document.getElementById('reportContent').value = report.content;
        
        document.getElementById('reportForm').onsubmit = async (e) => {
          e.preventDefault();
          await updateReport(id, new FormData(e.target));
        };
      } catch (error) {
        console.error('Error editing report:', error);
        showError('Failed to load report for editing');
      }
    }

    async function updateReport(id, formData) {
      try {
        const response = await fetch(`/api/reports/${id}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(Object.fromEntries(formData))
        });

        if (!response.ok) throw new Error('Failed to update report');
        
        closeReportModal();
        loadReports();
        showSuccess('Report updated successfully');
      } catch (error) {
        console.error('Error updating report:', error);
        showError('Failed to update report');
      }
    }

    async function deleteReport(id) {
      if (!confirm('Are you sure you want to delete this report?')) return;
      
      try {
        const response = await fetch(`/api/reports/${id}`, {
          method: 'DELETE'
        });

        if (!response.ok) throw new Error('Failed to delete report');
        
        loadReports();
        showSuccess('Report deleted successfully');
      } catch (error) {
        console.error('Error deleting report:', error);
        showError('Failed to delete report');
      }
    }

    function openReportForm() {
      const modal = document.getElementById('reportModal');
      if (!modal) return;

      modal.innerHTML = `
        <div class="modal-content">
          <h2>Create New Report</h2>
          <form id="reportForm" class="report-form">
            <div class="form-group">
              <label for="reportTitle">Title</label>
              <input type="text" id="reportTitle" name="title" required>
            </div>
            <div class="form-group">
              <label for="reportType">Type</label>
              <select id="reportType" name="type" required>
                <option value="farm">Farm Report</option>
                <option value="resource">Resource Report</option>
                <option value="community">Community Report</option>
              </select>
            </div>
            <div class="form-group">
              <label for="reportSummary">Summary</label>
              <textarea id="reportSummary" name="summary" required></textarea>
            </div>
            <div class="form-group">
              <label for="reportContent">Content</label>
              <textarea id="reportContent" name="content" required></textarea>
            </div>
            <div class="modal-buttons">
              <button type="submit" class="button">Save Report</button>
              <button type="button" onclick="closeReportModal()" class="button secondary">Cancel</button>
            </div>
          </form>
        </div>
      `;

      modal.style.display = 'block';
      
      document.getElementById('reportForm')?.addEventListener('submit', handleReportSubmit);
    }

    function closeReportModal() {
      const modal = document.getElementById('reportModal');
      if (modal) {
        modal.style.display = 'none';
      }
    }

    function showSuccess(message) {
      const messageContainer = document.getElementById('messageContainer');
      if (messageContainer) {
        messageContainer.innerHTML = `
          <div class="alert alert-success">
            ${escapeHtml(message)}
          </div>
        `;
        setTimeout(() => {
          messageContainer.innerHTML = '';
        }, 3000);
      }
    }
  </script>
</body>
</html> 